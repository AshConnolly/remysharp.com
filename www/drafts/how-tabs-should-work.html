<!DOCTYPE html PUBLIC "Uncompressed source: https://github.com/remy/remysharp.com"><html id="remysharp-com"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>How tabs should work</title><meta name="description" content="How tabs should work"/><meta name="HandheldFriendly" content="True"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="stylesheet" type="text/css" href="/css/screen.css?2.34"/><link rel="stylesheet" type="text/css" href="/css/zenburn.css?2.34"/><link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://feeds.feedburner.com/remysharp"/><link rel="alternate" type="text/xml" title="RSS .92" href="http://feeds.feedburner.com/remysharp"/><link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://feeds.feedburner.com/remysharp"/><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-1656750-1', 'auto');
ga('send', 'pageview');</script></head><body id="drafts-how-tabs-should-work-page"><nav class="main-nav clearfix subpanel"><form action="/search" class="search"><input type="text" name="q" placeholder="Search for..."/><input type="submit" value="Search"/></form><ul class="post-nav"><li class="home"><a href="/">Home</a></li><li class="search"><a id="search" href="#search">Search</a></li><li class="donate"><p><a href="https://www.paypal.me/rem"><img src="/images/donate.svg" alt="keep me honest"></a></p>
</li><li class="next"><a href="/2015/12/31/my-2015" title="My 2015">Latest post</a></li></ul></nav><main role="main" class="content"><div class="warning">Draft posts are a work in progress.&nbsp;Last edited 20-Dec 2015</div><article class="post"><h1 class="title"><a href="/drafts/how-tabs-should-work">How tabs should work</a><small class="edit"><a href="https://github.com/remy/remysharp.com/blob/master/public/drafts/how-tabs-should-work.md">(edit)</a></small></h1><div class="post-content"><p>Tabs in browsers (not <em>browser tabs</em>) are one of the oldest custom UI elements in a browser that I can think of. They&#39;ve been done to death. But, sadly, the majority of times I come across them, the tabs have been badly, or rather <em>partially</em> implemented.</p>
<p>So this post is my definition of how a tabbing system should work, and <em>one</em> approach of implementing that.</p>
<h2>But...tabs are easy, right?</h2><p>I&#39;ve been writing code for tabbing systems in JavaScript for coming up on a decade...and at one point I was pretty proud of how small I could make the JavaScript for the tabbing system:</p>
<pre><code class="language-js">var tabs = $(&#39;.tab&#39;).click(function () {
  tabs.hide().filter(this.hash).show();
}).map(function () {
  return $(this.hash)[0];
});

$(&#39;.tab:first&#39;).click();
</code></pre>
<p><a href="http://jsbin.com/metoya/edit?js,output">Simple, right</a>? Nearly fits in a tweet (ignoring the whole jQuery library...). Still, it&#39;s riddled with problems that make it a far from perfect solution.</p>
<h2>Requirements: what makes the perfect tab?</h2><ol>
<li>All content is navigable available without JavaScript (crawler compatible and lo-js compatible).</li>
<li>ARIA roles.</li>
<li>The <em>tabs</em> are anchor links that are:<ul>
<li>Clickable.</li>
<li>Have block layout.</li>
<li>Have their <code>href</code> pointing to the <code>id</code> of the panel element.</li>
<li>Uses correct cursor (ie. <code>cursor: pointer</code>).</li>
</ul>
</li>
<li>Since tabs are clickable, the user can <em>open in a new tab/window</em> and the page correctly loads with the right tab open.</li>
<li>Right clicking (and shift-clicking) <em>doesn&#39;t</em> cause the tab to be selected.</li>
<li>Browser native back/forward button correctly changes the state of the selected tab (think about it working exactly as if there was no JavaScript in place).</li>
</ol>
<p>The first three points are all to do with semantics of the markup and how the markup has been styled. I think it&#39;s easy to do a good job by thinking of tabs as links, and not as some part of an application. Links are navigable, and they should work the same way other links on the page work.</p>
<p>The last three points are JavaScript problems. Let&#39;s investigate that.</p>
<h2>The shitmus test</h2><p>Like a litmus test, here&#39;s a couple of quick ways you can tell if a tabbing systems is poorly implemented:</p>
<ul>
<li>Change tab, then use the back button (or keyboard shortcut) and it breaks</li>
<li>The tab isn&#39;t a link, so I can&#39;t open it in a new tab</li>
</ul>
<p>These two basic things are, to me, the bear minimum that a tabbing system should have.</p>
<h2>Why is this important?</h2><p>The people who push their &quot;native&quot; apps on users can&#39;t have more reasons why the web sucks. If something as basic as a tab doesn&#39;t work, obviously there&#39;s more ammo to push a closed native app or platform on your users.</p>
<p>If you&#39;re going to be a web developer, one of your responsibilities is to maintain established interactivity paradigms. This doesn&#39;t mean &quot;don&#39;t innovate&quot;. But it <em>does</em> mean: stop fucking up my scrolling experience with your poorly executed scroll effects. <code>&lt;/rant&gt;</code> <em>:breath:</em></p>
<h2>URI fragment, absolute URL or query string?</h2><p>A URI fragment (aka the # hash bit) would be using mysite.com/config#content to show the <em>content</em> panel. A fully addressable URL would be mysite.com/config/content. Using a query string (by way of &quot;filtering&quot; the page): mysite.com/config?tab=content.</p>
<p>This decision really depends on the context of your tabbing system. Something like Github&#39;s tabs to <a href="https://github.com/remy/remysharp.com/pull/6">view a pull request</a> makes sense that the full URL changes.</p>
<p>For our problem though, I want to solve the problem where the page doesn&#39;t do a full URL update, i.e. your regular run of the mill tabbing system.</p>
<p>I used to be from the school of using the hash to show the right tab, but I&#39;ve recently been exploring whether the query string can be used. The biggest reason is that multiple hashes doesn&#39;t work, and comma separated hash fragments doesn&#39;t make any sense to control multiple tabs (since it doesn&#39;t actually link to anything).</p>
<p>For this article, I&#39;ll keep focused on using a single tabbing system and a hash on the URL to control the tabs.</p>
<h2>Markup</h2><p>I&#39;m going to assume sub-content, so my markup would look like this (yes, this is a cat demo...):</p>
<pre><code class="language-html">&lt;ul class=&quot;tabs&quot;&gt;
  &lt;li&gt;&lt;a class=&quot;tab&quot; href=&quot;#dizzy&quot;&gt;Dizzy&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a class=&quot;tab&quot; href=&quot;#ninja&quot;&gt;Ninja&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a class=&quot;tab&quot; href=&quot;#missy&quot;&gt;Missy&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;div id=&quot;dizzy&quot;&gt;
  &lt;!-- panel content --&gt;
&lt;/div&gt;
&lt;div id=&quot;ninja&quot;&gt;
  &lt;!-- panel content --&gt;
&lt;/div&gt;
&lt;div id=&quot;missy&quot;&gt;
  &lt;!-- panel content --&gt;
&lt;/div&gt;
</code></pre>
<p>The important note in the markup is that the link used for the individual tab references it&#39;s panel content using the hash, pointing to the <code>id</code> on the panel. This will allow our content to connect up without JavaScript and give us a bunch of features for free which we&#39;ll see once we&#39;re on to writing the code.</p>
<h2>URL driven tabbing systems</h2><p>Instead of making the code responsive to the user&#39;s <em>input</em>, we&#39;re going to exclusively use the browser URL and the <code>hashchange</code> event on the <code>window</code> to drive this tabbing system. This way we get the back button support for free.</p>
<p>So with that in mind, let&#39;s start building up our code. I&#39;ll assume we have the jQuery library, but I&#39;ve also provided the full code working without a library, vanilla if you will, but it depends on relatively new (polyfill&#39;able) tech like <code>classList</code> and <code>dataset</code> (which generally has IE10 and all other browser support).</p>
<p><em>Note that I&#39;ll start with the simplest solution, and I&#39;ll re-factor the code as I go along, in places like where I keep calling jQuery selectors.</em></p>
<pre><code class="language-js">function show(id) {
  // remove the selected class from the tabs,
  // and add it back to the one the user selected
  $(&#39;.tab&#39;).removeClass(&#39;selected&#39;).filter(function () {
    return (this.hash === id);
  }).addClass(&#39;selected&#39;);

  // now hide all the panels, then filter to
  // the one we&#39;re interested in, and show it
  $(&#39;.panel&#39;).hide().filter(id).show();
}

$(window).on(&#39;hashchange&#39;, function () {
  show(location.hash);
});

// initialise by showing the first panel
show(&#39;#dizzy&#39;);
</code></pre>
<p>This works pretty well for such little code: <a href="http://output.jsbin.com/rimone/">http://output.jsbin.com/rimone/</a>. Notice that we don&#39;t have any click handlers for the user, and the back button works right out the box.</p>
<p>However, there&#39;s a number of problems we need to fix:</p>
<ol>
<li>The initialised tab is hard coded to the first panel, rather than what&#39;s on the URL.</li>
<li>If there&#39;s no hash on the URL, all the panels are hidden (and thus breaks).</li>
<li>If you scroll to the bottom of the example, you&#39;ll find a &quot;top&quot; link, clicking that will break our tabbing system.</li>
<li>I&#39;ve purposely made the page long, so that when you click on a tab, you&#39;ll see the page scrolls to the top of the tab, not a huge deal, but a bit annoying.</li>
</ol>
<p>Though, from our criteria at the start of this post, we&#39;ve already solved item (4) and (5). Not a terrible start. Let&#39;s solve items 1 through 3 next.</p>
<h3>Using the URL to initialise correctly &amp; protecting from breakage</h3><p>Instead of arbitrarily picking the first panel from our collection, the code should read the current <code>location.hash</code> and use that if it&#39;s available.</p>
<p>The problem is: what if the hash on the URL isn&#39;t actually for a tab?</p>
<p>The solution here is that we need to cache a list of known panel ids. In fact, well written DOM scripting won&#39;t continuously search the DOM for nodes. i.e. when the <code>show</code> function kept calling <code>$(&#39;.tab&#39;).each(...)</code> it was wasteful. The result of <code>$(&#39;.tab&#39;)</code> should be cached.</p>
<p>So now the code will collect all the tabs, then find the related panels <em>from</em> those tabs, and we&#39;ll use that list to double the values we give the <code>show</code> function (during initialisation for instance).</p>
<pre><code class="language-js">// collect all the tabs
var tabs = $(&#39;.tab&#39;);

// get an array of the panel ids (from the anchor hash)
var targets = tabs.map(function () {
  return this.hash;
}).get();

// use those ids to get a jQuery collection of panels
var panels = $(targets.join(&#39;,&#39;));

function show(id) {
  // if no value was given, let&#39;s take the first panel
  if (!id) {
    id = targets[0];
  }
  // remove the selected class from the tabs,
  // and add it back to the one the user selected
  tabs.removeClass(&#39;selected&#39;).filter(function () {
    return (this.hash === id);
  }).addClass(&#39;selected&#39;);

  // now hide all the panels, then filter to
  // the one we&#39;re interested in, and show it
  panels.hide().filter(id).show();
}

$(window).on(&#39;hashchange&#39;, function () {
  var hash = location.hash;
  if (targets.indexOf(hash) !== -1) {
    show(hash);
  }
});

// initialise
show(targets.indexOf(location.hash) !== -1 ? location.hash : &#39;&#39;);
</code></pre>
<p>The core of working out what tab to initialise with is solved in that last line: is there a <code>location.hash</code>, is it in our list of valid target (panels)? If so, select that tab.</p>
<p>The second breakage that we saw in the original demo is that clicking the &quot;top&quot; link, would break our tabs, this was because the <code>hashchange</code> event fired and the code didn&#39;t validate the hash that was passed. Now this happens, the panels don&#39;t break.</p>
<p>So far we&#39;ve got a tabbing system that:</p>
<ul>
<li>Works without JavaScript.</li>
<li>Supports right click and shift click (and doesn&#39;t select in these cases).</li>
<li>Loads the right panel if you start with a hash.</li>
<li>Browser native navigation works.</li>
<li>Keyboard support works.</li>
</ul>
<p>The only annoying problem we have now, is the page jumps when a tab is selected. That&#39;s because the browser is following the default behaviour of an internal link on the page. To solve this, things are going to get a little hairy, but it&#39;s all for a good cause.</p>
<h3>Removing the jumping to tab</h3><p>You&#39;d be forgiven for thinking you just need to hook a click handler and <code>return false</code>. It&#39;s what I started with. Only that&#39;s not the solution. If we add the click handler, it breaks all the right click and shift click support.</p>
<p>There may be another way to solve this, but this is the way <em>I</em> found, and it works. It&#39;s just a bit...hairy, as I said.</p>
<p>We&#39;re going to strip the <code>id</code> attribute off the target panel when the user tries to navigate to it, and then put it back on once the <code>show</code> code starts to run. This change will mean the browser has no where to navigate to for that moment, and won&#39;t jump the page.</p>
<p>The change involves the following:</p>
<ol>
<li>Add a click handle that removes the <code>id</code> from the target panel, and cache this in a <code>target</code> variable that we&#39;ll use later in <code>hashchange</code> (see point 4).</li>
<li>In the same click handler, set the <code>location.hash</code> to the current link&#39;s hash - this is important because it forces a <code>hashchange</code> event regardless of whether the URL actually changed which prevents the tabs breaking (try it yourself by removing this line).</li>
<li>For each panel, put a backup copy of the <code>id</code> attribute in a <code>data</code> property (I&#39;ve called it <code>old-id</code>).</li>
<li>When the <code>hashchange</code> event fires, if we have a <code>target</code> value, let&#39;s put the <code>id</code> <em>back</em> on the panel.</li>
</ol>
<p>These changes result in this final code:</p>
<pre><code class="language-js">/*global $*/

// a temp value to cache *what* we&#39;re about to show
var target = null;

// collect all the tabs
var tabs = $(&#39;.tab&#39;).on(&#39;click&#39;, function () {
  target = $(this.hash).removeAttr(&#39;id&#39;);

  // if the URL isn&#39;t going to change, then hashchange
  // event doesn&#39;t fire, so we trigger the update manually
  if (location.hash === this.hash) {
    // but this has to happen after the DOM update has
    // completed, so we wrap it in a setTimeout 0
    setTimeout(update, 0);
  }
});

// get an array of the panel ids (from the anchor hash)
var targets = tabs.map(function () {
  return this.hash;
}).get();

// use those ids to get a jQuery collection of panels
var panels = $(targets.join(&#39;,&#39;)).each(function () {
  // keep a copy of what the original el.id was
  $(this).data(&#39;old-id&#39;, this.id);
});

function update() {
  if (target) {
    target.attr(&#39;id&#39;, target.data(&#39;old-id&#39;));
    target = null;
  }

  var hash = window.location.hash;
  if (targets.indexOf(hash) !== -1) {
    show(hash);
  }
}

function show(id) {
  // if no value was given, let&#39;s take the first panel
  if (!id) {
    id = targets[0];
  }
  // remove the selected class from the tabs,
  // and add it back to the one the user selected
  tabs.removeClass(&#39;selected&#39;).filter(function () {
    return (this.hash === id);
  }).addClass(&#39;selected&#39;);

  // now hide all the panels, then filter to
  // the one we&#39;re interested in, and show it
  panels.hide().filter(id).show();
}

$(window).on(&#39;hashchange&#39;, update);

// initialise
if (targets.indexOf(window.location.hash) !== -1) {
  update();
} else {
  show();
}
</code></pre>
<p>This version, <a href="http://output.jsbin.com/xilula/">http://output.jsbin.com/xilula/</a> now has all the criteria I listed in my original criteria, <em>except</em> for the aria roles and accessibility. Getting this support is actually very cheap to add.</p>
<h3>ARIA roles</h3><p>This article on <a href="http://accessibility.athena-ict.com/aria/examples/tabpanel2.shtml">ARIA tabs</a> made it very easy to get the tabbing system working as I wanted.</p>
<p>The tasks were simple:</p>
<ol>
<li>Add <code>aria-role</code> set to <code>tab</code> for the tabs, and <code>panel</code> for the panels.</li>
<li>Set <code>aria-controls</code> on the tabs to point to their related panel (by id).</li>
<li>I use JavaScript to add <code>tabindex=0</code> to all the tab elements.</li>
<li>When I add the <code>selected</code> class to the tab, I also set <code>aria-selected</code> to <code>true</code> and inversely, when I remove the <code>selected</code> class, I set <code>aria-selected</code> to <code>false</code>.</li>
<li>When I hide the panels, I add <code>aria-hidden=true</code> and when I show the specific panel, I set <code>aria-hidden=false</code>.</li>
</ol>
<p>And that&#39;s it. Very small changes to get full sign off that the tabbing system is bullet proof and accessible.</p>
<p>The final version is here: <a href="http://output.jsbin.com/lorovu/">http://output.jsbin.com/lorovu/</a> (and non-jQuery version as promised: <a href="http://jsbin.com/sehuxo/edit?js,output">http://jsbin.com/sehuxo/edit?js,output</a>).</p>
<h2>In summary</h2><p>There&#39;s a <em>lot</em> of tab implementations out there, but there&#39;s an equal amount that break the browsing paradigm and the simple link-ability of content. Clearly there&#39;s a special hell for those tab systems that don&#39;t even use links, but I think it&#39;s clear that even in something that&#39;s relatively simple, it&#39;s the small details that make or break the user experience.</p>
<p>Obviously there&#39;s corners that I&#39;ve not explored, like when there&#39;s more than one set of tabs on a page, and equally whether you should deliver the initial markup with the correct tab selected. I think the answer lies in using query strings in combination with hashes on the URL, but maybe that&#39;s for another year!</p><p class="update">Drafts may be incomplete or entirely abandonded, so please forgive me. If you find an issue with a draft, or would like to see me write about something specifically, please try <a href="http://github.com/remy/remysharp.com/issues/new">raising an issue</a>.</p></div></article></main><footer class="site-footer clearfix flex subpanel"><div class="flex-item archives"><h2>Archives</h2><ul><li><a href="/archive">All years</a></li><li><a href="/2015">2015</a></li><li><a href="/2014">2014</a></li><li><a href="/2013">2013</a></li><li><a href="/2012">2012</a></li><li><a href="/2011">2011</a></li><li><a href="/2010">2010</a></li><li><a href="/2009">2009</a></li><li><a href="/2008">2008</a></li><li><a href="/2007">2007</a></li><li><a href="/2006">2006</a></li></ul></div><div class="flex-item links"><h2>Links</h2><ul><li><a href="/about">About Remy</a></li><li><a href="/ethos">Ethos (WIP)</a></li><li><a target="_blank" href="/feed.xml">RSS feed</a></li><li><a href="/search">Search</a></li><li><a target="_blank" href="https://github.com/remy">On GitHub</a></li><li><a target="_blank" href="https://twitter.com/rem">On Twitter</a></li><li><a target="_blank" href="http://lanyrd.com/profile/rem/past/speaking/">Presentations</a></li><li><a href="/house-rules">House Rules</a></li></ul></div><div class="flex-item license"><h2>License</h2><p class="vcard">All content by <a class="url fn" href="https://remysharp.com">Remy Sharp</a> and under <a href="http://creativecommons.org/licenses/by-nc-sa/2.0/uk/">creative commons</a> and code under <a href="http://rem.mit-license.org">MIT&nbsp;license</a>.</p><p>All code and content for this blog is available as <a href="https://github.com/remy/remysharp.com">open source on GitHub</a>.</p>
<p><a href="https://www.paypal.me/rem"><img src="/images/donate-hotpink.svg" alt="keep me honest"></a></p>
</div></footer><script src="//code.jquery.com/jquery-1.11.1.min.js"></script><script>window.jQuery || document.write('<script src="/js/jquery.min.js"><\/script>')</script><script src="/js/jquery.fitvids.js"></script><script src="/js/highlight.min.js"></script><script src="/js/permalink.js?2.34"></script><script src="/js/index.js?2.34"></script><!--|  
|  
|  Carved up by hand using Harp and a shit load of hacking.
|  
|  Also, this:
|  
|  
|  
|                        \_            /;              _.._
|                        `\~--.._     //'            ,(+=\\\\
|                         `//////\  \\/;'             /~ (\\\\
|                           ~/////\~\`)'             /;   ))))
|                               `~'  |              ((`~/((((\
|                               ;'_\'\             /'))   )))))
|                              /~/ '" "'     _.  /'/\_ /^\`((( \
|                             `\/'       _.-~/--/ (  =(   | ,  |
|                                     _/~\_)_}___/^\/~`\.__\|==|
|                                    /uUUU)        )        |  |
|                                   (   / |      _-=o|\__ /'/~ \
|                                   ' /'  |     /(((((\`\(  |~\/
|                                   /'    |   /' )))))"`\`\|/_/---.._,$$,
|                             .,ssS$$$Sss|._/_..-((('    )\)>>>      ~\$
|                          ,sS$$$$$$$$$$$|$$$$$$$  |/    //'~`o        `\
|                        ,$$$$$$$$$$$$$$|$$S$$$$'  (    /                \
|                      ,$$$$$$$$$$$$S$$|$$$$$$$'   |   /              ,s$$$
|                    s$$$$$S$$$$$$$$$S|$$$$$$$$    |  /              $$$$$$
|                  _~,$S""''     ``"S|$$S$$$$$"    (_,`\,          ,$$$$$$$;
|                /~ ,"'             / 'S$$$$$"      \_./|        s$$$$$$$$$$
|             (~'      _,  \==~~)  /     """         \  |       $$$$$$$$$$$$
|              (0\   /0/     \-' /'                   \ |  |  ,$$$$$$$$$$$$$,
|              `/'  '         _-~                     |= \_-\ $$$$$$$$$$$$$$s
|              (~~~)      _.-~_-   \             \  ,s|= |   `"$$$$$$$$$$$$$$$
|             ( `-'  )/>-~  _/-__   |            |,$$$|_/,      `"$$$$$$$$$$$$
|             /V^^^^V~/' _/~/~~  ~~-|            |$$$$$$$$         "$$$$$$$$$$,
|            /  (^^^^),/' /'        )           /S$$$$$$$;         ,$$$$$$$$$$$,
|          ,$$_  `~~~'.,/'         /     _-ss, /(/-(/-(/'        ,s$$$$$$$$$$$$$
|        ,s$$$$$ssSS$$$'         ,$'.s$$$$$$$$'                  (/-(/-(/-(/-(/'
|       S$$$$$$$$$$$$$$        ,$$$$$$$$$$$$$'
|      (/-(/-(/-(/-(/'      _s$$$$$$$$$$$$$$
|                          (/-(/-(/-(/-(/-'
|  
|  
|  
|      – Remy
|  
|  --><!-- Env: production - static files--></body></html>